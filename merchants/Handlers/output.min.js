!function(s){s.fn.loadBusinessProfile=function(t){var e=s.extend({bHost:"core/",bScript:"getBusiness.php",businessId:"1"},t);s.ajax({type:"GET",url:e.bHost+e.bScript+"?business="+e.businessId,success:function(t){var e=JSON.parse(t);s(".BrandName").html(e[0].businessName),s(".Brand_Desc").html(e[0].Description),s(".brandAddress").html(e[0].businessBuildingNumber+","+e[0].businessStreet+","+e[0].businessCityId+","+e[0].businessProvinceId,NaN+e[0].businessPostalcode)}})},s.fn.loadBusinessRatings=function(t){var e=s.extend({bHost:"core/",bScript:"getRatings.php",businessId:"1"},t);s.ajax({type:"GET",url:e.bHost+e.bScript+"?business="+e.businessId,success:function(t){for(var e=JSON.parse(t),n=0,i=0;i<e.length;i++){var n=n+parseInt(e[i].score),o="";o+="<div class=SingleUserComment> <span class=profilePicOfUser><img src=images/profile/c2.jpg height=30 width=30 class=ActualPicContent><br/><span class=CommenterName>"+e[i].user[0].Firstname+" "+e[i].user[0].Lastname+"</span><br/><span class=CommentContent>"+e[i].reviewContent+"</span></span></div>",s(".UserComments").append(o)}n/=e.length,s(".YourInterestLevel span").html(n)}})},s.fn.loadFollowers=function(t){var e=s.extend({bHost:"core/",bScript:"getFollowers.php",businessId:"1"},t);s.ajax({type:"GET",url:e.bHost+e.bScript+"?business="+e.businessId,success:function(t){var e=JSON.parse(t);s(".followersCount .fCount").html(e.length)}})},s.fn.addFollower=function(t){var e=s.extend({bHost:"core/",bScript:"addFollower.php",businessId:"1"},t);s.ajax({type:"GET",url:e.bHost+e.bScript+"?business="+e.businessId,success:function(t){var e=JSON.parse(t);console.log(e),1==e&&(s(".followersCount .FollowWidget").addClass("following"),s(".followersCount .FollowWidget").html("Following"))}})},s.fn.getUserInteractions=function(t){var e=s.extend({bHost:"core/",bScript:"checkFollowStatus.php",businessId:"1"},t);s.ajax({type:"GET",url:e.bHost+e.bScript+"?business="+e.businessId,success:function(t){var e=JSON.parse(t);console.log(e),1==e&&(s(".followersCount .FollowWidget").addClass("following"),s(".followersCount .FollowWidget").html("Following"))}})},s.fn.getPrices=function(t){var e=s(this).attr("data-key");switch(e){case"smb":s(this).find(".pointsCount").html("100").fadeIn(2e3),s(this).find(".ptsText").html("CAD").fadeIn(2e3);break;case"mlb":s(this).find(".pointsCount").html("200").fadeIn(2e3),s(this).find(".ptsText").html("CAD").fadeIn(2e3);break;case"vlb":s(this).find(".pointsCount").html("400").fadeIn(2e3),s(this).find(".ptsText").html("CAD").fadeIn(2e3)}},s.fn.reversePrices=function(t){var e=s(this).attr("data-key");switch(e){case"smb":s(this).find(".pointsCount").text("10000").fadeIn(2e3),s(this).find(".ptsText").text("Points").fadeIn(2e3);break;case"mlb":s(this).find(".pointsCount").text("50000").fadeIn(2e3),s(this).find(".ptsText").text("Points").fadeIn(2e3);break;case"vlb":s(this).find(".pointsCount").text("50000").fadeIn(2e3),s(this).find(".ptsText").text("Points").fadeIn(2e3)}},s.fn.getBusinessPosts=function(t){var e=s.extend({bHost:"core/",bScript:"getBusinessPosts.php",businessId:"1"},t),n=s(this);s.ajax({type:"GET",url:e.bHost+e.bScript+"?business="+e.businessId,success:function(s){var t=JSON.parse(s);if(console.log(t),0!=t)for(var e=0;e<t.length;e++)if("photo"==t[e].contentType){var i="uploads/photos/",o="";o+="<div class='post photoPost'>",o+='                        <div class="postBottomContainer">',o+='                            <img src="images/paylet_logo.png" height="40" class="profile_icon" />',o+='                            <div class="postBy">'+t[e].user[0].businessName+"</div>",o+="",o+="                        </div>",o+='                        <div class="postTopContainer">',o+='                            <div class="photo">',o+="                                <img src="+i+t[e].postData[0].photoName+" />",o+="                            </div>",o+='                            <div class="postContent">',o+="                               "+t[e].postData[0].photoContent+"</div>",o+="                        </div>",o+='<div class="postBottomContainer">',o+='                            <div class=postReach> <img src=images/post/reach.png height=30 /> <span> 1000</span></div><div class=postPulse> <img src=images/post/pulse.png height=30 /> <span> 1000</span></div><div class="postedOn">'+t[e].postData[0].dateTime+"</div>",o+='                            <div class="postedFrom"><img src="images/loc.svg" height="14"><span class="locName">Montreal</span></div>',o+="",o+="",o+="                        </div>",o+="                    </div>",n.append(o)}}})},s.fn.storeFbPage=function(t){var e=s.extend({bHost:"core/",bScript:"addFbPage.php",pageId:""},t);s(this);s.ajax({type:"GET",url:e.bHost+e.bScript+"?pageId="+e.pageId,success:function(s){var t=JSON.parse(s);console.log(t)}})},s.fn.checkFbPage=function(t){var e=s.extend({bHost:"core/",bScript:"checkFbPage.php"},t),n=s(this);s.ajax({type:"GET",url:e.bHost+e.bScript,success:function(s){console.log(s);var t=JSON.parse(s);0!=t&&n.hide()}})},s.fn.checkSubscription=function(t){var e,n=s.extend({bHost:"core/",bScript:"checkSub.php"},t);s(this);s.ajax({type:"GET",url:n.bHost+n.bScript,success:function(t){var n=JSON.parse(t);e=n,0==n?(s(".notSubscribed").show(),s(".pointRegister,.nextBlockHeading,.graphOfCustomers,.pointsRemaining,.buyPoints").hide()):(s(".notSubscribed,.buyPoints").hide(),s(".pointRegister,.nextBlockHeading,.graphOfCustomers").show())}}),"function"==typeof t.callback&&t.callback.apply(this,[e]),s(".startButton").click(function(){s(".buyPoints").show(),s("html,body").animate({scrollTop:s(".buyPoints").offset().top},1e3)})},s.fn.getPointModals=function(t){var e=s.extend({bHost:"core/",bScript:"getPointAreas.php"},t);s(this);s.ajax({type:"GET",url:e.bHost+e.bScript,success:function(t){var e=JSON.parse(t);console.log(e);var n=e.length/2;s(".setDist").html(" "),s("#remPoints").html(e[0].RemPoints+"<span>Remaining</span>");for(var i=0;i<e.length;i++){var o="<table width='100%'><tr><td class=mDown>"+e[i].pointsName+"</td><td class=space><div class=settedPoint>"+e[i].points+"</div><input type=text style='display: none;' class=setPoint value="+e[i].points+" /></td></tr></table>";n>i?s("#setDist1").append(o):s("#setDist2").append(o)}}})},s.fn.getPointRegister=function(t){var e=s.extend({bHost:"core/",bScript:"getPointRegister.php"},t);s(this);s.ajax({type:"GET",url:e.bHost+e.bScript,success:function(t){for(var e=JSON.parse(t),n=0;n<e.length;n++)"CR"==e[n].ACTION?s(".pointRegister").append(" <div class=regPointsSingle><img src=images/rewards/reach.png height=50 /><span>"+e[n].points+" Points cashed in at "+e[n].datetime+"</span> </div>"):s(".pointRegister").append(" <div class=regPointsSingle><img src=images/rewards/dist.png height=50 /><span>"+e[n].points+" Points distributed at "+e[n].datetime+"</span> </div>")}})},s.fn.getAllBusiness=function(t){var e=s.extend({bHost:"core/",bScript:"getAllBusiness.php"},t);s(this);s.ajax({type:"GET",url:e.bHost+e.bScript,success:function(t){var e=JSON.parse(t);s(".account_settings").html(" ");for(var n=0;n<e.length;n++)1>n&&s(".account_settings").html("<span class=settingsSpan><img src=images/icons/settings.png class=settingsImg height=20><span class=settingTitle data-key='"+e[0].businessId+"'><span>"+e[0].businessName+"</span><img src=images/icons/down.png class=arrowDown height=10 > </span></span><div class=dropDown></div>"),n>=1&&s(".account_settings .dropDown").append("<div class='singleItemDropdown item' data-key='"+e[n].businessId+"'>"+e[n].businessName+"</div>");s(".account_settings .dropDown").append("<div class=singleItemDropdown onclick='location.href=newBusiness.php;'> + Add New Business</div>")}})},s.fn.getPrice=function(t){var e=s.extend({bHost:"core/",bScript:"getPrice.php"},t);s(this);s.ajax({type:"GET",url:e.bHost+e.bScript,success:function(s){}})},s.fn.getDashboardMetrics=function(t){var e=s.extend({bHost:"core/",bScript:"getDashboardMetrics.php"},t);s(this);s.ajax({type:"GET",url:e.bHost+e.bScript,success:function(t){var e=JSON.parse(t);console.log(e),s(".purchases span.count2").html(e.purchases.improvement),s(".purchases span.count1").html(e.purchases["new"]),s(".engagements span.count2").html(e.engagements.improvement),s(".engagements span.count1").html(e.engagements["new"])}})},s.fn.getRewardsInsights=function(t){var e=s.extend({bHost:"core/",bScript:"getRewardsInsights.php",action:"CR"},t);s(this);s.ajax({type:"GET",url:e.bHost+e.bScript+"?action="+e.action,success:function(s){result=JSON.parse(s);var t={labels:[result[0].month,result[1].month,result[2].month,result[3].month],datasets:[{label:"Distributed",fillColor:"rgba(241, 196, 15,1.0)",strokeColor:"rgba(241, 196, 15,1.0)",highlightFill:"rgba(220,220,220,0.75)",highlightStroke:"rgba(220,220,220,1)",data:[result[0].points,result[1].points,result[2].points,result[3].points]},{label:"CashedIn",fillColor:"rgba(243, 156, 18,1.0)",strokeColor:"rgba(243, 156, 18,1.0)",highlightFill:"rgba(151,187,205,0.75)",highlightStroke:"rgba(151,187,205,1)",data:[0,0,0,0]}]},e=document.getElementById("graphCanvas").getContext("2d");window.myBar=new Chart(e).Bar(t,{responsive:!0,bezierCurveTension:0,scaleShowGridLines:!1})}}),"function"==typeof t.callback&&t.callback.apply([data])},s.fn.getInsights=function(t){var e=s.extend({bHost:"core/",bScript:"insights.php",action:"CR"},t);s(this);s.ajax({type:"GET",url:e.bHost+e.bScript,success:function(s){result=JSON.parse(s);var t={labels:[result[1][0].itemType,result[1][0].itemType,result[1][0].itemType,result[1][0].itemType],datasets:[{fillColor:"rgba(241, 196, 15,0)",strokeColor:"rgba(241, 196, 15,1.0)",highlightFill:"rgba(220,220,220,0.75)",highlightStroke:"rgba(220,220,220,1)",data:[result[1].length,result[2].length,result[3].length,result[4].length]},{fillColor:"rgba(243, 156, 18,0)",strokeColor:"rgba(243, 156, 18,1.0)",highlightFill:"rgba(151,187,205,0.8)",highlightStroke:"rgba(151,187,205,1)",data:[0,0,0,0]}]},e=document.getElementById("graphCanvas").getContext("2d");window.myBar=new Chart(e).Line(t,{responsive:!0,bezierCurveTension:0,scaleShowGridLines:!1})}})}}(jQuery);